<app-loader *ngIf="isLoading"></app-loader>
<div class="notifications">
  <button mat-raised-button class="notification-icon" (click)="openNotifications()">
    <span class="notification-number">{{notifications.length}}</span>
    <mat-icon>notifications_active</mat-icon>
  </button>
  <div class="notifications-container" *ngIf="isOpenNotification">
    <div class="notification" *ngFor="let notification of notifications">
      <span>
        {{notification.contact | nameByIdPipe : contacts}}
      </span>
      <span>
        {{notification.date | date:'dd.MM.yyyy'}}
      </span>
      <button mat-icon-button matTooltip="Mark as seen" (click)="markEventAsViewed(notification)">
        <mat-icon class="check-icon">check_circle</mat-icon>
      </button>
    </div>

  </div>
</div>
<div class="layout">
  <div class="btn-container">
    <button mat-raised-button color="primary" (click)="openReminderModal()">
      <mat-icon>date_range</mat-icon>ADD EVENT</button>
  </div>
  <div class="table-container">
    <table mat-table [dataSource]="remindersDataSource" class="mat-elevation-z8">
      <ng-container matColumnDef="contact">
        <th mat-header-cell *matHeaderCellDef>
          Contact
        </th>
        <td mat-cell *matCellDef="let reminder">
          <span>
            {{reminder.contact| nameByIdPipe : contacts}}
          </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef>
          Date
        </th>
        <td mat-cell *matCellDef="let reminder">
          <span>
            {{reminder.date | date:'dd.MM.yyyy'}}
          </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="reminder">
        <th mat-header-cell *matHeaderCellDef>
          Reminder
        </th>
        <td mat-cell *matCellDef="let reminder">
          <span>
            {{reminder.reminder| labelByCodePipe : reminders}}
          </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="note">
        <th mat-header-cell *matHeaderCellDef class="custom-w-note">
          Note
        </th>
        <td mat-cell *matCellDef="let reminder" class="custom-w-note">
          <span *ngIf="reminder.note">
            <mat-icon matTooltip='{{reminder.note }}'>info</mat-icon>
          </span>
        </td>
      </ng-container>
      <ng-container matColumnDef="button">
        <th mat-header-cell *matHeaderCellDef>
        </th>
        <td mat-cell *matCellDef="let reminder">
          <div class="custom-w">
            <button matTooltip="Edit reminder" mat-flat-button (click)="editReminder(reminder)">
              <mat-icon [color]="'primary'">edit</mat-icon>
            </button>
            <button matTooltip="Delete reminder" mat-flat-button (click)="deleteReminder(reminder)">
              <mat-icon [color]="'warn'">delete</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let reminder; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[10, 20, 50]" showFirstLastButtons [pageSize]="pageSize || 10" [length]="tableSize" (page)="getRemindersData()">
    </mat-paginator>

    <span *ngIf="!(remindersDataSource && remindersDataSource.data && remindersDataSource.data.length)">Няма намерени
      резултати</span>
  </div>
</div>
